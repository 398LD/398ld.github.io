function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}!function(t,e){if(!e||"function"!=typeof e)throw new Error("epctrl require jQuery");var r=!!document.all&&document.querySelector&&!document.addEventListener,n=function(t){return t=t.toLowerCase(),epctrl._rootPath+"/"+t+"/"+t+".js"},o=function(t){throw new Error(t)},s=function(t){var r;"function"!=typeof epctrl[t]&&(r=t,e.ajax({url:n(r),type:"get",dataType:"TEXT",async:!1}).done(function(t){var e=document.createElement("script");e.text=t,document.getElementsByTagName("head")[0].appendChild(e)}).fail(o))},i=function(){this._events={},this.cssUrl=[],this.jsUrl=[],this.htmlUrl="",this.htmlContainer=!1,this._FnQueues=[];var t=arguments[0].events;if(t)for(var e in t)t.hasOwnProperty(e)&&this.on(e,t[e]);this.on("afterCreate",this._onCreate)};i.prototype={type:"control",constructor:i,_jsPromise:{},_getControlPath:function(){return"frame/fui/js/widgets/epcontrols/"+this.type.toLowerCase()+"/"},on:function(t,e,r){return"string"!=typeof t?(this.print("the first arguments type is requird as string","error"),this):"function"!=typeof e?(this.print("the second arguments fn is requird as function","error"),this):(t=t.toLowerCase(),this._events[t]||(this._events[t]=[]),this._events[t].push(r?[e,r]:[e]),this)},off:function(t,e){t=t.toLowerCase();var r=this._events[t];if(!r||!r.length)return this;if(e)for(var n=0;n<r.length;++n)e===r[n][0]&&(r.splice(n,1),--n);else this._events[t]=r=[];return this},fire:function(t,r){t=t.toLowerCase();var n,o=this._events[t],s=e.extend({type:t,origin:this,cancel:!1},r);if(!o)return s;for(var i=0,l=o.length;i<l;++i)n=o[i][0],s.scope=o[i][1]||this,n.call(s.scope,s);return s},one:function(t,e,r){var n=this;return this.on(t,function o(){n.off(t,o),e.apply(r||n,arguments)},r),this},_loadJsPromise:function(t){if(!t)return e.Deferred().resolve().promise();if(this._jsPromise[t])return this._jsPromise[t];var n=this,s=e.Deferred(),i=document.createElement("script");return i.type="text/javascript",r&&i.readyState?i.onreadystatechange=function(){"loaded"!=i.readyState&&"complete"!=i.readyState||(s.resolve(),i.onreadystatechange=null)}:(i.onload=function(){s.resolve(),i.onload=null},i.onerror=function(){s.reject(),i.onerror=null,n._jsPromise[t]=null,o(t+"：此资源加载失败！")}),this.fire("beforeOneJsload",{jsUrl:t}),i.src=epctrl._rootPath+"/"+t,document.getElementsByTagName("head")[0].appendChild(i),this._jsPromise[t]=s.promise()},loadJs:function(t,r){var n=e.Deferred();if(!t||!t.length)return e.fn.jquery>="3"?e.Deferred().resolve().promise().then(function(){r&&r()}):(setTimeout(function(){n.resolve()}),n.promise().then(function(){r&&r()}));var o=this;"string"==typeof t&&(t=[t]),this.fire("beforeJsload",{jsUrl:t});var s=JSON.parse(JSON.stringify(t));return this._loadJsPromise(s[0]).then(function n(){return o.fire("afterOneJsload",{js:s[0]}),s.splice(0,1),s.length?o._loadJsPromise(s[0]).done(n).fail(o.throwError):(o.fire("afterJsLoad",{jsUrl:t}),e.Deferred().resolve().promise().then(function(){r&&r()}))})},loadCss:function(t,e,r){"string"==typeof t&&(t=[t]);for(var n=null,o=(document.getElementsByTagName("head")[0],0),s=t.length;o<s;++o)document.getElementById("style-"+this.type+(s>1?"-"+o:""))||((n=document.createElement("link")).rel="stylesheet",n.id="style-"+this.type+(s>1?"-"+o:""),n.href=epctrl._rootPath+"/"+t[o])},loadHtml:function(t){if(!t||!this.htmlContainer)return e.Deferred().resolve().promise();var r=this.fire("beforeHTMLLoad",{htmlUrl:t});this.htmlUrl=t=r.htmlUrl;var n=this;return e.ajax({url:epctrl._rootPath+"/"+t,type:"GET",async:!0,dataType:"HTML"}).done(function(r){var o=n.fire("beforeHtmlInsert",{htmlUrl:t,content:r,htmlContainer:n.htmlContainer});r=o.content,n.htmlContainer=o.htmlContainer,r&&n.htmlContainer&&e(r).appendTo(n.htmlContainer),n.fire("afterHTMLLoad",{htmlUrl:t,content:r,htmlContainer:n.htmlContainer})})},addCss:function(t){if(t){var r=this.cssUrl;t+""===t&&(t=[t]),e.each(t,function(t,e){r.push(e)})}},setCss:function(t){return t+""===t?this.cssUrl.push(t):this.cssUrl=t},setJs:function(t){return t+""===t?this.jsUrl.push(t):this.jsUrl=t},setHtml:function(t){return this.htmlUrl=t},setHtmlContainer:function(t){return this.htmlContainer=t},getHtmlContainer:function(){return this.htmlContainer},getHtml:function(){return this.htmlUrl},getCss:function(){return this.cssUrl},getJs:function(){return this.jsUrl},addJs:function(t){if(t){var r=this.jsUrl;t+""===t&&(t=[t]),e.each(t,function(t,e){r.push(e)})}},loadSource:function(){var t=this,e=this.fire("beforeSourceLoad",{cssUrl:this.cssUrl,jsUrl:this.jsUrl});this.cssUrl=e.cssUrl,this.jsUrl=e.jsUrl,this.cssUrl&&this.loadCss(this.cssUrl),this.loadHtml(this.htmlUrl).then(function(){return t.loadJs(t.jsUrl,function(){t.fire("afterSourceLoad",{cssUrl:t.cssUrl,jsUrl:t.jsUrl}),t.create()})})},create:function(){this.throwError("控件未提供初始化方法，初始化失败！")},_onCreate:function(t){for(var e,r=t.origin,n=r._FnQueues;n.length;)(e=n.splice(0,1)[0])[0].apply(r,e[1])},_cacheFn:function(t){if("function"==typeof t){var e=Array.prototype.slice.call(arguments,1);this._FnQueues.push([t,e])}else this.throwError("The first argument must be a function")},throwError:o,print:function(e,r){if(t.console&&t.console.log)switch(r){case"info":console.log(e);break;case"warn":console.warn(e);break;case"error":console.error(e);break;default:console.log(e)}}},t.epctrl={_rootPath:"/component",extend:function(t,e,r){var n=this[t.substr(0,1).toUpperCase()+t.substr(1)];if("function"!=typeof n)throw new Error("在epctrl下未找到"+t+"的定义，请确认控件名称正确！");return s(e),function(t,e,r){if("function"!=typeof e)return this;(r=r||{})._jsPromise||(r._jsPromise={});var n=t,o=n.prototype,s=e.prototype;if(n.superclass!=s){var i;for(i in n.superclass=s,n.superclass.constructor=e,s)o[i]=s[i];if(r)for(i in r)o[i]=r[i];return n}}(n,epctrl[e],r)},overwrite:function(t,e){return s(t),function(t,e){var r;if("function"==typeof t)r=t.prototype;else{if("object"!=_typeof(t))return this;r=t}for(var n in e)r[n]=e[n];return t}(epctrl[t],e)},Control:i,init:function(t,e){var r=t.substr(0,1).toUpperCase()+t.substr(1);if(!this[r]||"function"!=typeof this[r])throw new Error("指定的控件："+t+" 未找到，请确认控件名称正确！");var n=new this[r](e);return n.loadSource(),n}}}(this,jm);